<!-- Theme Selector for Dark/Light Mode -->
<div class="theme-selector" id="theme-selector">
  <button id="theme-light" title="Light Mode" aria-label="Switch to light mode">â˜€ï¸</button>
  <button id="theme-dark" title="Dark Mode" aria-label="Switch to dark mode">ğŸŒ™</button>
  <button id="theme-auto" title="Auto (System)" aria-label="Use system preference" class="active">ğŸ–¥ï¸</button>
</div>

<script>
(function() {
  'use strict';

  // Theme management
  const theme = {
    get current() {
      return localStorage.getItem('theme') || 'auto';
    },
    set current(value) {
      localStorage.setItem('theme', value);
      this.apply(value);
    },
    apply(theme) {
      const html = document.documentElement;
      const buttons = document.querySelectorAll('#theme-selector button');

      // Remove active class from all buttons
      buttons.forEach(btn => btn.classList.remove('active'));

      if (theme === 'auto') {
        // Use system preference
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        html.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
        document.getElementById('theme-auto').classList.add('active');
      } else {
        // Use explicit theme
        html.setAttribute('data-theme', theme);
        document.getElementById(`theme-${theme}`).classList.add('active');
      }
    },
    init() {
      // Apply current theme on load
      this.apply(this.current);

      // Set up button event listeners
      document.getElementById('theme-light').addEventListener('click', () => {
        this.current = 'light';
      });

      document.getElementById('theme-dark').addEventListener('click', () => {
        this.current = 'dark';
      });

      document.getElementById('theme-auto').addEventListener('click', () => {
        this.current = 'auto';
      });

      // Listen for system theme changes when in auto mode
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (this.current === 'auto') {
          this.apply('auto');
        }
      });
    }
  };

  // Initialize theme on DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => theme.init());
  } else {
    theme.init();
  }
})();
</script>